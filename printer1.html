<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Print Progress</title>
    <link rel="stylesheet" href="print-progress.css">
</head>
<body data-printer-ip=""
      data-printer-name=""
      data-update-interval="2000"
      data-debug="false"
      data-camera-url="">
    <!-- EASY CONFIG: change only these values -->
    <script>
        window.PRINTER_CONFIG = {
            name: 'Printer 1',
            ip: 'printer1.local', // printer IP/hostname
            camera: '', // leave blank to auto-build from IP
            flipHorizontal: false, // set true if the raw stream is mirrored
            flipVertical: false,   // set true if the raw stream is upside down
            updateInterval: 2000, // ms
            debug: false
        };
        (function applyConfig(cfg) {
            if (!cfg) return;
            const b = document.body;
            const ip = cfg.ip || b.dataset.printerIp || 'localhost';
            b.dataset.printerName = cfg.name || b.dataset.printerName || 'Printer';
            b.dataset.printerIp = ip;
            b.dataset.cameraUrl = cfg.camera || b.dataset.cameraUrl || '';
            b.dataset.cameraFlipX = String(cfg.flipHorizontal ?? b.dataset.cameraFlipX ?? 'false');
            b.dataset.cameraFlipY = String(cfg.flipVertical ?? b.dataset.cameraFlipY ?? 'false');
            b.dataset.updateInterval = String(cfg.updateInterval || cfg.intervalMs || b.dataset.updateInterval || 2000);
            const debugVal = cfg.debug;
            b.dataset.debug = String(debugVal === undefined ? b.dataset.debug || 'false' : debugVal);

            if (!b.dataset.cameraUrl && ip) {
                // Default webcam path so the IP only has to be set once.
                b.dataset.cameraUrl = 'http://' + ip + '/webcam/?action=stream';
            }
        })(window.PRINTER_CONFIG);
    </script>
    <div class="scene">
        <div class="frame">
            <div class="camera">
                <div class="corner">
                    <div class="printer-name" id="printerName">Printer</div>
                    <div class="status-pill ok" id="status">Connecting...</div>
                </div>
                <div class="overlay-info">
                    <div class="info-chip">
                        <span class="label">Layer</span>
                        <span class="value" id="layerInfo">--</span>
                    </div>
                    <div class="info-chip">
                        <span class="label">File</span>
                        <span class="value" id="filename">--</span>
                    </div>
                    <div class="info-chip">
                        <span class="label">Hotend</span>
                        <span class="value" id="hotendTemp">--</span>
                    </div>
                    <div class="info-chip">
                        <span class="label">Bed</span>
                        <span class="value" id="bedTemp">--</span>
                    </div>
                </div>
                <img id="cameraFeed" alt="Printer camera feed">
                <div class="overlay-bottom">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 0%;">
                            <span class="progress-label">Progress</span>
                            <span id="percentage">0%</span>
                        </div>
                    </div>
                    <div class="detail">
                        <span class="muted">Time Remaining</span>
                        <span id="timeRemaining">--</span>
                    </div>
                </div>
            </div>
        </div>
        <div id="debugInfo" class="debug hidden"></div>
    </div>

    <script src="print-progress.js"></script>
</body>
</html>
