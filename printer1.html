<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Print Progress</title>
    <link rel="stylesheet" href="print-progress.css">
</head>
<body data-printer-ip=""
      data-printer-name=""
      data-update-interval="2000"
      data-debug="false"
      data-camera-url="">
    <!-- EASY CONFIG: change only these values -->
    <script>
        window.PRINTER_CONFIG = {
            name: '',
            ip: '', // printer IP/hostname
            camera: '', // leave blank to auto-build from IP
            flipHorizontal: false, // set true if the raw stream is mirrored
            flipVertical: false,   // set true if the raw stream is upside down
            showChamber: false,    // set true if you have a chamber thermistor
            updateInterval: 2000, // ms
            debug: false
        };
        (function applyConfig(cfg) {
            if (!cfg) return;
            const b = document.body;
            const ip = cfg.ip || b.dataset.printerIp || 'localhost';
            b.dataset.printerName = cfg.name || b.dataset.printerName || 'Printer';
            b.dataset.printerIp = ip;
            b.dataset.cameraUrl = cfg.camera || b.dataset.cameraUrl || '';
            b.dataset.cameraFlipX = String(cfg.flipHorizontal ?? b.dataset.cameraFlipX ?? 'false');
            b.dataset.cameraFlipY = String(cfg.flipVertical ?? b.dataset.cameraFlipY ?? 'false');
            b.dataset.chamberEnabled = String(cfg.showChamber ?? b.dataset.chamberEnabled ?? 'false');
            b.dataset.updateInterval = String(cfg.updateInterval || cfg.intervalMs || b.dataset.updateInterval || 2000);
            const debugVal = cfg.debug;
            b.dataset.debug = String(debugVal === undefined ? b.dataset.debug || 'false' : debugVal);

            if (!b.dataset.cameraUrl && ip) {
                // Default webcam path so the IP only has to be set once.
                b.dataset.cameraUrl = 'http://' + ip + '/webcam/?action=stream';
            }
        })(window.PRINTER_CONFIG);
    </script>
    <div class="scene">
        <div class="frame">
            <div class="camera">
                <div class="corner">
                    <div class="printer-name" id="printerName">Printer</div>
                    <div class="status-pill ok" id="status">Connecting...</div>
                </div>
		<div id="previewFloating">
        		<img id="thumbnail" class="thumb-img" src="" alt="Preview Thumbnail">
        	<div id="thumbnailFilename" class="thumb-file-label">--</div>
    		</div>
                <div class="overlay-info">
                    <div class="info-chip">
                        <span class="label">Layer</span>
                        <span class="value" id="layerInfo">--</span>
                    </div>
                    <div class="info-chip">
                        <span class="label">File</span>
                        <span class="value" id="filename">--</span>
                    </div>
                    <div class="info-chip">
                        <span class="label">Hotend</span>
                        <span class="value" id="hotendTemp">--</span>
                    </div>
                    <div class="info-chip">
                        <span class="label">Bed</span>
                        <span class="value" id="bedTemp">--</span>
                    </div>		    
                    <div class="info-chip" id="chamberChip">
                        <span class="label">Chamber</span>
                        <span class="value" id="chamberTemp">--</span>
                    </div>
                </div>
                <img id="cameraFeed" alt="Printer camera feed">
                <div class="overlay-bottom">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 0%;"></div>
                        <div class="progress-text">
                            <span class="progress-label">Progress</span>
                            <span id="percentage">0%</span>
                        </div>
                    </div>
                    <div class="detail">
                        <div class="time-block">
                            <span class="muted">Estimate</span>
                            <span id="timeEstimate">--</span>
                        </div>
                        <div class="time-block">
                            <span class="muted">Slicer</span>
                            <span id="timeSlicer">--</span>
                        </div>
                        <div class="time-block">
                            <span class="muted">Elapsed</span>
                            <span id="timeTotal">--</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="debugInfo" class="debug hidden"></div>
    </div>

    <script src="print-progress.js"></script>
</body>
</html>
